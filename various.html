<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Various about statistics and insurance</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="publications.html">Publications</a>
</li>
<li>
  <a href="various.html">Statistics</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:boriscout@hotmail.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
<li>
  <a href="https://ch.linkedin.com/in/boris-polanco-47962964">
    <span class="fa fa-linkedin fa-2x"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Various about statistics and insurance</h1>

</div>


<p>One of the most interesting theoretical about Non life Insurance for me was the idea of compound process. Using this formulation, we can obtain the usual expression to determine the total claim amount also called in some well known aplications as pure premium.</p>
<div id="the-compound-process" class="section level2">
<h2>The Compound Process</h2>
<p>Is a random sum where the upper summation index is a counting process. In general we have that:</p>
<p><span class="math display">\[Z_t=\sum_{j=0}^{N_t}X_j\]</span></p>
<p>It is called the total loss or the total claim amount. Is easy to prove that the moment generating function of <span class="math inline">\(Z_t\)</span> is given by <span class="math display">\[M_{Z_t}(v)=M_{N_t}(log(M_X(v)))\]</span> In addition to that, we know the next property of the moment generating function: <span class="math display">\[E(X^k)=M^{(k)}(0)\]</span></p>
<p>Using this fact, we can get the expected value for the total loss or total claim amount.</p>
<p><span class="math display">\[\begin{align*}
E(Z_t)&amp;=M&#39;_{N_t}(log(M_X(0)))\times\frac{M&#39;_X(0)}{M_X(0)}\\
E(Z_t)&amp;=E(N_t)E(X_1)
\end{align*}\]</span></p>
</div>
<div id="the-method-of-inverse-transform." class="section level2">
<h2>The method of Inverse Transform.</h2>
<p>This method is useful to generate a random variable with distribution function <span class="math inline">\(F\)</span></p>
<p>Is based on the next theorem:</p>
<p><span class="math inline">\(\textbf{Theorem}\\\)</span> Let <span class="math inline">\(F\)</span> a distribution function and <span class="math inline">\(U\sim Uniform(0,1)\)</span>, then:</p>
<ul>
<li><p><span class="math inline">\(X=F^{-1}(U)\sim F\)</span></p></li>
<li><p><span class="math inline">\(F(X)\sim Uniform(0,1)\)</span></p></li>
</ul>
</div>
<div id="the-risk-process" class="section level2">
<h2>The Risk Process</h2>
<p>We consider <span class="math inline">\(X_1,X_2,...\)</span> independent individual random losses or claim amounts, with distribution function <span class="math inline">\(F\)</span></p>
<p><span class="math inline">\(k_t\)</span>: Individual number of claims ocurring during <span class="math inline">\([0,t]\)</span> <span class="math inline">\(\forall t\geq 0\)</span>.</p>
<p><span class="math inline">\(\{k_t\}_{t\geq 0}\)</span>: Is a birth process independent of <span class="math inline">\(\{X_k\}_{k\geq 1}\)</span></p>
<p>The <span class="math inline">\(\textbf{total loss}\)</span> or <span class="math inline">\(\textbf{claim amount}\)</span> is <span class="math display">\[Z_t=\sum_{k=0}^{k_t}X_k\]</span> where <span class="math inline">\(X_0=0\)</span>.</p>
<p>Let <span class="math inline">\(r_0\)</span> the initial capital and <span class="math inline">\(c&gt;0\)</span> be the premium rate (assumed constant)</p>
<p><span class="math display">\[Y_t=r_o+ct-Z_t\]</span> is the risk process.</p>
</div>
<div id="heavy-and-light-tails-in-non-life-insurance." class="section level2">
<h2>Heavy and Light tails in Non life Insurance.</h2>
<p>One of the topics of interest for me is the mathematical ideas behind reinsurance.</p>
<p>One of the topics of relevance, is the extreme value theory. We introduced the concept of heavy and light tailed distributions. The basic interpretation of it is:</p>
<ul>
<li><p>A distribution is light tailed, if is assigned smaller probabilities for larger values of the variable <span class="math inline">\(x\)</span>.</p></li>
<li><p>A distribution is heavy tailed, if is assigned larger probabilities to larger values of the variable <span class="math inline">\(x\)</span>.</p></li>
</ul>
<p><span class="math inline">\(\textbf{Some examples:}\)</span> For heavy tailed distributions we have for instance:</p>
<p>-The top of the <span class="math inline">\(1\%\)</span> of the world has the <span class="math inline">\(40\%\)</span> of the wealth.</p>
<p>-The top of the <span class="math inline">\(2\%\)</span> of twitter users post the <span class="math inline">\(60\%\)</span> of tweets</p>
</div>
<div id="some-important-things-about-statisticcal-quality-control." class="section level2">
<h2>Some important things about Statisticcal Quality Control.</h2>
<p>During my studies in Switzerland, I applied for an internship in a Swiss company. I started an internship in one of the most important companies in the field of Pharma and Biotech. I have been learning a lot about Quality control and some other appliactions of statistics. It has been really interesting. I have not enoguh time to post something in this blog, but I don’t want to forget how to do that from R. I attach a brief summary of useful stuff during my internship. I hope someday to post in a dayly basis.</p>
</div>
<div id="kernel-density-estimation" class="section level2">
<h2>Kernel density estimation</h2>
<p>KDE is a non parametric way to estimato the probability density function of a random variable, introduced by Rosenblatt (1956). There are about 30 packages that performs density estimation problem in R</p>
</div>
<div id="overview-of-the-problem" class="section level2">
<h2>Overview of the problem</h2>
<p>Let n i.i.d data points <span class="math inline">\(X_1,X_2,...,X_n\)</span>, we are interested in an estimate $ = (s)$, of the true density <span class="math inline">\(f(x)\)</span>.</p>
</div>
<div id="histogram" class="section level2">
<h2>Histogram</h2>
<p>Is the oldest (1840’s) and least sophisticated method of density estimation. Example: This data set contains the thickness and additional data for 84 metal plates. We have <span class="math inline">\(84\)</span> observations on the following <span class="math inline">\(5\)</span> variables.</p>
<ul>
<li><p>day: a factor with the day (seven days)</p></li>
<li><p>shift: a factor with the shift (two shifts)</p></li>
<li><p>thickness: a numeric vector with the thickness (in)</p></li>
<li><p>ushift: a factor with the day-shift combination</p></li>
<li><p>flaws: an integer vector with the number of flaws on the surface of sampled plates</p></li>
</ul>
<pre class="r"><code>library(SixSigma)</code></pre>
<pre><code>## Warning: package &#39;SixSigma&#39; was built under R version 4.1.3</code></pre>
<pre class="r"><code>data&lt;-ss.data.thickness2

#We present an histogram of the variable thickness 
hist(data$thickness,main=&quot;Histogram thickness&quot;,col=&quot;blue&quot;,xlab=&quot;thickness&quot;)</code></pre>
<p><img src="various_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="what-is-a-kernel" class="section level2">
<h2>What is a Kernel?</h2>
<p>A kernel is a special type of probability function with the following properties:</p>
<ul>
<li>non-negative</li>
<li>real-valued</li>
<li>even</li>
<li>Its definite integral over its support set must equal one.</li>
</ul>
<p>Rosenblatt proposed putting smooth kernel weights in each of the observations.</p>
</div>
<div id="constructing-a-kernel-density-estimate" class="section level2">
<h2>Constructing a Kernel density estimate</h2>
<ul>
<li>1 Choose a kernel; the common ones are Gaussian, uniform, rectangular and triangular. <span class="math display">\[\hat{f}_h(x)=\frac{1}{n}\sum_{i=1}^nK_h(x-X_i)+\frac{1}{nh}\sum_{i=1}^nK(\frac{x-X_1}{h})\]</span> Where <span class="math inline">\(K_h(x)=\frac{1}{h}K(\frac{x}{h})\)</span> with <span class="math inline">\(K\)</span> a kernel and <span class="math inline">\(h\)</span> is the bandwith.</li>
</ul>
</div>
<div id="kernel-density-estimation-in-r" class="section level2">
<h2>Kernel density Estimation in R</h2>
<p>From the library stats, we have the density function that computes kernel density estimates. The function has the next parameters: - x: The data from wich the estimate is to be computed. - bw: The smothing bandwith used. - kernel: A character string giving the smoothing kernel to be used, “gaussian”,“rectangular”, “triangular”,..etc. - n: The number of equally spaced points at which the density is to be estimated, in this case the bw will be equals to length of x divided to n-1 - from,to: left and right points of the grid at wich the density is to be estimated.</p>
<pre class="r"><code>#First we simulate a set of 12 batches
batches&lt;-rgamma(n = 12,shape=7,rate=0.005)

dens&lt;-density(batches,from = 0,to=3000,n=10)
plot(dens)
dens</code></pre>
<pre><code>## 
## Call:
##  density.default(x = batches, n = 10, from = 0, to = 3000)
## 
## Data: batches (12 obs.); Bandwidth &#39;bw&#39; = 168.3
## 
##        x              y            
##  Min.   :   0   Min.   :0.000e+00  
##  1st Qu.: 750   1st Qu.:3.150e-07  
##  Median :1500   Median :7.373e-05  
##  Mean   :1500   Mean   :2.999e-04  
##  3rd Qu.:2250   3rd Qu.:6.559e-04  
##  Max.   :3000   Max.   :1.007e-03</code></pre>
<pre class="r"><code>##Grid
(3000-0)/9</code></pre>
<pre><code>## [1] 333.3333</code></pre>
<pre class="r"><code>dens$x</code></pre>
<pre><code>##  [1]    0.0000  333.3333  666.6667 1000.0000 1333.3333 1666.6667 2000.0000
##  [8] 2333.3333 2666.6667 3000.0000</code></pre>
<pre class="r"><code>plot(dens)</code></pre>
<p><img src="various_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="the-johnson-transformation" class="section level2">
<h2>The Johnson Transformation</h2>
<p>Most of the statistical analysis assumes normality. However in practice, it is not common get variables with non-normal distribution and one alternative is to transform the data, that is the application of a mathematical function to the original dataset.</p>
<p>The <span class="math inline">\(Z\)</span> family of distributions is composed by three distributions named Unbounded <span class="math inline">\(SU\)</span>, Lognormal <span class="math inline">\(SL\)</span>, and Bounded <span class="math inline">\(SB\)</span>, which allow to transform into a normal distribution selecting one of the three of them. The transformations are:</p>
<p><span class="math display">\[\begin{align*}
Z&amp;=\gamma+\eta sinh^{-1}\frac{x-\epsilon}{\lambda}\\
\text{where }\eta,\lambda&amp;&gt;0,-\infty&lt;\gamma&lt;\infty, -\infty&lt;\epsilon&lt;\infty \text{ and } -\infty&lt;x&lt;\infty\\
Z&amp;=\gamma+\eta \ln^{-1}(x-\epsilon)\\
\text{where }\eta&amp;&gt;0,-\infty&lt;\gamma&lt;\infty, -\infty&lt;\epsilon&lt;\infty \text{ and }\epsilon&lt;x\\
Z&amp;=\gamma+\eta\ln(\frac{x-\epsilon}{\lambda+\epsilon-x})\\
\text{where }\eta,\lambda&amp;&gt;0,-\infty&lt;\gamma&lt;\infty, -\infty&lt;\epsilon&lt;\infty \text{ and } -\epsilon&lt;x&lt;\epsilon+\lambda
\end{align*}\]</span></p>
<p>From the previous expressions we can perform the inverse transformation, using the results of estimated parameters, for instance: $$ <span class="math display">\[\begin{align*}
\frac{Z-\gamma}{\eta}&amp;=\sinh^{-1}(\frac{x-\epsilon}{\lambda})\\
\lambda \sinh(\frac{Z-\gamma}{\eta})+\epsilon=x
\end{align*}\]</span></p>
<p>$$</p>
<pre class="r"><code>library(Johnson)
set.seed(100)
batches&lt;-rexp(n = 12,rate=0.005)
johnson_batches&lt;-RE.Johnson(batches)
johnson_batches$&#39;function&#39;</code></pre>
<pre><code>## [1] &quot;SB&quot;</code></pre>
<pre class="r"><code>## A SU transformation was used with the next parameters
lambda&lt;-johnson_batches$f.lambda
gamma&lt;-johnson_batches$f.gamma
epsilon&lt;-johnson_batches$f.epsilon
eta&lt;-johnson_batches$f.eta
#Using the inverse formula we get the original values, the same argument used in the other families.
#There is a nice explanation about  the discrimination of three families in The Johnson System: Selection and Parameter Estimation  by James F. Slifker &amp; Samuel S. Shapiro .

## after the inverse transformation the original data coincide
epsilon+(lambda*sinh((johnson_batches$transformed-gamma)/(eta)))</code></pre>
<pre><code>##  [1]  -3464.06330  -4652.51609 -36517.84218    -12.57262  -5514.49065
##  [6]  -2533.80734 -41133.93270  -1351.56135 -14875.09136 -19335.23912
## [11]  -6705.76078 -10818.12165</code></pre>
<pre class="r"><code>batches</code></pre>
<pre><code>##  [1] 184.84232 144.76744  20.92897 619.47247 124.96105 234.88587  18.62344
##  [8] 349.67815  49.99859  38.86529 105.02043  67.60868</code></pre>
</div>
<div id="empirical-distribution-function" class="section level2">
<h2>Empirical Distribution Function</h2>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
